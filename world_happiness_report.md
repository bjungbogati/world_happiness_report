---
title: "World Happiness Report"
author: "Binod Jung Bogati"
date: "7/22/2018"
output: 
  html_document:
    keep_md: yes
    theme: readable
---



# Load data from World Happiness Report 


```r
# load required library
library(tidyverse)
```

```
## ── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.2.1 ──
```

```
## ✔ ggplot2 3.0.0     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.8.0     ✔ stringr 1.3.0
## ✔ readr   1.1.1     ✔ forcats 0.3.0
```

```
## ── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
```

```r
y17 <- read.csv("./data/2017.csv", stringsAsFactors = FALSE)
```


```r
head(y17)
```

```
##       Country Happiness.Rank Happiness.Score Whisker.high Whisker.low
## 1      Norway              1           7.537     7.594445    7.479556
## 2     Denmark              2           7.522     7.581728    7.462272
## 3     Iceland              3           7.504     7.622030    7.385970
## 4 Switzerland              4           7.494     7.561772    7.426227
## 5     Finland              5           7.469     7.527542    7.410458
## 6 Netherlands              6           7.377     7.427426    7.326574
##   Economy..GDP.per.Capita.   Family Health..Life.Expectancy.   Freedom
## 1                 1.616463 1.533524                0.7966665 0.6354226
## 2                 1.482383 1.551122                0.7925655 0.6260067
## 3                 1.480633 1.610574                0.8335521 0.6271626
## 4                 1.564980 1.516912                0.8581313 0.6200706
## 5                 1.443572 1.540247                0.8091577 0.6179509
## 6                 1.503945 1.428939                0.8106961 0.5853845
##   Generosity Trust..Government.Corruption. Dystopia.Residual
## 1  0.3620122                     0.3159638          2.277027
## 2  0.3552805                     0.4007701          2.313707
## 3  0.4755402                     0.1535266          2.322715
## 4  0.2905493                     0.3670073          2.276716
## 5  0.2454828                     0.3826115          2.430182
## 6  0.4704898                     0.2826618          2.294804
```

# Rename column names


```r
names(y17) <- c("country", "rank", "score", "whisker_high", "whisker_low", "gdp", "family", "life_expectancy", "freedom", "generosity", "corruption", "dystopia")
```

# Top 10 happiest country


```r
top10_happy <- head(y17, 10)
```


```r
top10_happy$country <- factor(top10_happy$country, levels = top10_happy$country[order(-top10_happy$score)])

ggplot(top10_happy, aes(x = country, y = score, fill = country)) +
  geom_bar(stat = "identity", aes(width = 0.4)) +
  labs(title = "Top 10 World's Happiest Countries") +
  geom_text(aes(label = round(score, 2)), position = position_stack(vjust = 0.5), size = 3)
```

```
## Warning: Ignoring unknown aesthetics: width
```

![](world_happiness_report_files/figure-html/unnamed-chunk-5-1.png)<!-- -->

# Least Happy Countries


```r
least10_happy <- tail(y17, 10)

least10_happy$country <- factor(least10_happy$country, levels = least10_happy$country[order(least10_happy$score)])
  
ggplot(least10_happy, aes(x = country, y = score, fill = country)) +
  geom_bar(stat = "identity", aes(width = 0.4)) +
  labs(title = "Top 10 World's Least Happiest Countries") +
  geom_text(aes(label = round(score, 2)), position = position_stack(vjust = 0.5), size = 3)
```

```
## Warning: Ignoring unknown aesthetics: width
```

![](world_happiness_report_files/figure-html/unnamed-chunk-6-1.png)<!-- -->

# Add the region in the dataframe


```r
y16 <- read.csv("./data/2016.csv", stringsAsFactors = FALSE)

y16_select <- y16 %>% 
  select(Country, Region)

names(y16_select) <- c("country", "region") 

y17_full <- right_join(y16_select, y17, by = "country")

# check if country has no region
which(is.na(y17_full),arr.ind=TRUE)
```

```
##      row col
## [1,]  33   2
## [2,]  71   2
## [3,] 113   2
## [4,] 139   2
## [5,] 155   2
```

```r
y17_full %>% 
  filter(is.na(region))
```

```
##                    country region rank score whisker_high whisker_low
## 1 Taiwan Province of China   <NA>   33 6.422     6.494596    6.349404
## 2  Hong Kong S.A.R., China   <NA>   71 5.472     5.549594    5.394406
## 3               Mozambique   <NA>  113 4.550     4.774102    4.325898
## 4                  Lesotho   <NA>  139 3.808     4.044344    3.571656
## 5 Central African Republic   <NA>  155 2.693     2.864884    2.521116
##         gdp   family life_expectancy   freedom generosity corruption
## 1 1.4336265 1.384565      0.79398423 0.3614666  0.2583605 0.06382924
## 2 1.5516748 1.262791      0.94306242 0.4909686  0.3744658 0.29393375
## 3 0.2343056 0.870701      0.10665444 0.4807911  0.3222281 0.17943639
## 4 0.5210212 1.190095      0.00000000 0.3906613  0.1574973 0.11909464
## 5 0.0000000 0.000000      0.01877269 0.2708420  0.2808765 0.05656508
##    dystopia
## 1 2.1266074
## 2 0.5546331
## 3 2.3556509
## 4 1.4298353
## 5 2.0660048
```

```r
y17_full$region[c(33, 71, 113, 139, 155)] <- c("Eastern Asia","Eastern Asia", "Sub-Saharan Africa", "Sub-Saharan Africa", "Sub-Saharan Africa")

y17_full
```

```
##                      country                          region rank score
## 1                     Norway                  Western Europe    1 7.537
## 2                    Denmark                  Western Europe    2 7.522
## 3                    Iceland                  Western Europe    3 7.504
## 4                Switzerland                  Western Europe    4 7.494
## 5                    Finland                  Western Europe    5 7.469
## 6                Netherlands                  Western Europe    6 7.377
## 7                     Canada                   North America    7 7.316
## 8                New Zealand       Australia and New Zealand    8 7.314
## 9                     Sweden                  Western Europe    9 7.284
## 10                 Australia       Australia and New Zealand   10 7.284
## 11                    Israel Middle East and Northern Africa   11 7.213
## 12                Costa Rica     Latin America and Caribbean   12 7.079
## 13                   Austria                  Western Europe   13 7.006
## 14             United States                   North America   14 6.993
## 15                   Ireland                  Western Europe   15 6.977
## 16                   Germany                  Western Europe   16 6.951
## 17                   Belgium                  Western Europe   17 6.891
## 18                Luxembourg                  Western Europe   18 6.863
## 19            United Kingdom                  Western Europe   19 6.714
## 20                     Chile     Latin America and Caribbean   20 6.652
## 21      United Arab Emirates Middle East and Northern Africa   21 6.648
## 22                    Brazil     Latin America and Caribbean   22 6.635
## 23            Czech Republic      Central and Eastern Europe   23 6.609
## 24                 Argentina     Latin America and Caribbean   24 6.599
## 25                    Mexico     Latin America and Caribbean   25 6.578
## 26                 Singapore               Southeastern Asia   26 6.572
## 27                     Malta                  Western Europe   27 6.527
## 28                   Uruguay     Latin America and Caribbean   28 6.454
## 29                 Guatemala     Latin America and Caribbean   29 6.454
## 30                    Panama     Latin America and Caribbean   30 6.452
## 31                    France                  Western Europe   31 6.442
## 32                  Thailand               Southeastern Asia   32 6.424
## 33  Taiwan Province of China                    Eastern Asia   33 6.422
## 34                     Spain                  Western Europe   34 6.403
## 35                     Qatar Middle East and Northern Africa   35 6.375
## 36                  Colombia     Latin America and Caribbean   36 6.357
## 37              Saudi Arabia Middle East and Northern Africa   37 6.344
## 38       Trinidad and Tobago     Latin America and Caribbean   38 6.168
## 39                    Kuwait Middle East and Northern Africa   39 6.105
## 40                  Slovakia      Central and Eastern Europe   40 6.098
## 41                   Bahrain Middle East and Northern Africa   41 6.087
## 42                  Malaysia               Southeastern Asia   42 6.084
## 43                 Nicaragua     Latin America and Caribbean   43 6.071
## 44                   Ecuador     Latin America and Caribbean   44 6.008
## 45               El Salvador     Latin America and Caribbean   45 6.003
## 46                    Poland      Central and Eastern Europe   46 5.973
## 47                Uzbekistan      Central and Eastern Europe   47 5.971
## 48                     Italy                  Western Europe   48 5.964
## 49                    Russia      Central and Eastern Europe   49 5.963
## 50                    Belize     Latin America and Caribbean   50 5.956
## 51                     Japan                    Eastern Asia   51 5.920
## 52                 Lithuania      Central and Eastern Europe   52 5.902
## 53                   Algeria Middle East and Northern Africa   53 5.872
## 54                    Latvia      Central and Eastern Europe   54 5.850
## 55               South Korea                    Eastern Asia   55 5.838
## 56                   Moldova      Central and Eastern Europe   56 5.838
## 57                   Romania      Central and Eastern Europe   57 5.825
## 58                   Bolivia     Latin America and Caribbean   58 5.823
## 59              Turkmenistan      Central and Eastern Europe   59 5.822
## 60                Kazakhstan      Central and Eastern Europe   60 5.819
## 61              North Cyprus                  Western Europe   61 5.810
## 62                  Slovenia      Central and Eastern Europe   62 5.758
## 63                      Peru     Latin America and Caribbean   63 5.715
## 64                 Mauritius              Sub-Saharan Africa   64 5.629
## 65                    Cyprus                  Western Europe   65 5.621
## 66                   Estonia      Central and Eastern Europe   66 5.611
## 67                   Belarus      Central and Eastern Europe   67 5.569
## 68                     Libya Middle East and Northern Africa   68 5.525
## 69                    Turkey Middle East and Northern Africa   69 5.500
## 70                  Paraguay     Latin America and Caribbean   70 5.493
## 71   Hong Kong S.A.R., China                    Eastern Asia   71 5.472
## 72               Philippines               Southeastern Asia   72 5.430
## 73                    Serbia      Central and Eastern Europe   73 5.395
## 74                    Jordan Middle East and Northern Africa   74 5.336
## 75                   Hungary      Central and Eastern Europe   75 5.324
## 76                   Jamaica     Latin America and Caribbean   76 5.311
## 77                   Croatia      Central and Eastern Europe   77 5.293
## 78                    Kosovo      Central and Eastern Europe   78 5.279
## 79                     China                    Eastern Asia   79 5.273
## 80                  Pakistan                   Southern Asia   80 5.269
## 81                 Indonesia               Southeastern Asia   81 5.262
## 82                 Venezuela     Latin America and Caribbean   82 5.250
## 83                Montenegro      Central and Eastern Europe   83 5.237
## 84                   Morocco Middle East and Northern Africa   84 5.235
## 85                Azerbaijan      Central and Eastern Europe   85 5.234
## 86        Dominican Republic     Latin America and Caribbean   86 5.230
## 87                    Greece                  Western Europe   87 5.227
## 88                   Lebanon Middle East and Northern Africa   88 5.225
## 89                  Portugal                  Western Europe   89 5.195
## 90    Bosnia and Herzegovina      Central and Eastern Europe   90 5.182
## 91                  Honduras     Latin America and Caribbean   91 5.181
## 92                 Macedonia      Central and Eastern Europe   92 5.175
## 93                   Somalia              Sub-Saharan Africa   93 5.151
## 94                   Vietnam               Southeastern Asia   94 5.074
## 95                   Nigeria              Sub-Saharan Africa   95 5.074
## 96                Tajikistan      Central and Eastern Europe   96 5.041
## 97                    Bhutan                   Southern Asia   97 5.011
## 98                Kyrgyzstan      Central and Eastern Europe   98 5.004
## 99                     Nepal                   Southern Asia   99 4.962
## 100                 Mongolia                    Eastern Asia  100 4.955
## 101             South Africa              Sub-Saharan Africa  101 4.829
## 102                  Tunisia Middle East and Northern Africa  102 4.805
## 103  Palestinian Territories Middle East and Northern Africa  103 4.775
## 104                    Egypt Middle East and Northern Africa  104 4.735
## 105                 Bulgaria      Central and Eastern Europe  105 4.714
## 106             Sierra Leone              Sub-Saharan Africa  106 4.709
## 107                 Cameroon              Sub-Saharan Africa  107 4.695
## 108                     Iran Middle East and Northern Africa  108 4.692
## 109                  Albania      Central and Eastern Europe  109 4.644
## 110               Bangladesh                   Southern Asia  110 4.608
## 111                  Namibia              Sub-Saharan Africa  111 4.574
## 112                    Kenya              Sub-Saharan Africa  112 4.553
## 113               Mozambique              Sub-Saharan Africa  113 4.550
## 114                  Myanmar               Southeastern Asia  114 4.545
## 115                  Senegal              Sub-Saharan Africa  115 4.535
## 116                   Zambia              Sub-Saharan Africa  116 4.514
## 117                     Iraq Middle East and Northern Africa  117 4.497
## 118                    Gabon              Sub-Saharan Africa  118 4.465
## 119                 Ethiopia              Sub-Saharan Africa  119 4.460
## 120                Sri Lanka                   Southern Asia  120 4.440
## 121                  Armenia      Central and Eastern Europe  121 4.376
## 122                    India                   Southern Asia  122 4.315
## 123               Mauritania              Sub-Saharan Africa  123 4.292
## 124      Congo (Brazzaville)              Sub-Saharan Africa  124 4.291
## 125                  Georgia      Central and Eastern Europe  125 4.286
## 126         Congo (Kinshasa)              Sub-Saharan Africa  126 4.280
## 127                     Mali              Sub-Saharan Africa  127 4.190
## 128              Ivory Coast              Sub-Saharan Africa  128 4.180
## 129                 Cambodia               Southeastern Asia  129 4.168
## 130                    Sudan              Sub-Saharan Africa  130 4.139
## 131                    Ghana              Sub-Saharan Africa  131 4.120
## 132                  Ukraine      Central and Eastern Europe  132 4.096
## 133                   Uganda              Sub-Saharan Africa  133 4.081
## 134             Burkina Faso              Sub-Saharan Africa  134 4.032
## 135                    Niger              Sub-Saharan Africa  135 4.028
## 136                   Malawi              Sub-Saharan Africa  136 3.970
## 137                     Chad              Sub-Saharan Africa  137 3.936
## 138                 Zimbabwe              Sub-Saharan Africa  138 3.875
## 139                  Lesotho              Sub-Saharan Africa  139 3.808
## 140                   Angola              Sub-Saharan Africa  140 3.795
## 141              Afghanistan                   Southern Asia  141 3.794
## 142                 Botswana              Sub-Saharan Africa  142 3.766
## 143                    Benin              Sub-Saharan Africa  143 3.657
## 144               Madagascar              Sub-Saharan Africa  144 3.644
## 145                    Haiti     Latin America and Caribbean  145 3.603
## 146                    Yemen Middle East and Northern Africa  146 3.593
## 147              South Sudan              Sub-Saharan Africa  147 3.591
## 148                  Liberia              Sub-Saharan Africa  148 3.533
## 149                   Guinea              Sub-Saharan Africa  149 3.507
## 150                     Togo              Sub-Saharan Africa  150 3.495
## 151                   Rwanda              Sub-Saharan Africa  151 3.471
## 152                    Syria Middle East and Northern Africa  152 3.462
## 153                 Tanzania              Sub-Saharan Africa  153 3.349
## 154                  Burundi              Sub-Saharan Africa  154 2.905
## 155 Central African Republic              Sub-Saharan Africa  155 2.693
##     whisker_high whisker_low        gdp    family life_expectancy
## 1       7.594445    7.479556 1.61646318 1.5335236     0.796666503
## 2       7.581728    7.462272 1.48238301 1.5511216     0.792565525
## 3       7.622030    7.385970 1.48063302 1.6105740     0.833552122
## 4       7.561772    7.426227 1.56497955 1.5169117     0.858131289
## 5       7.527542    7.410458 1.44357193 1.5402467     0.809157670
## 6       7.427426    7.326574 1.50394464 1.4289392     0.810696125
## 7       7.384403    7.247597 1.47920442 1.4813490     0.834557652
## 8       7.379510    7.248490 1.40570605 1.5481951     0.816759706
## 9       7.344095    7.223905 1.49438727 1.4781622     0.830875158
## 10      7.356651    7.211349 1.48441494 1.5100420     0.843886793
## 11      7.279853    7.146146 1.37538242 1.3762900     0.838404000
## 12      7.168112    6.989888 1.10970628 1.4164037     0.759509265
## 13      7.070670    6.941330 1.48709726 1.4599450     0.815328419
## 14      7.074657    6.911343 1.54625928 1.4199206     0.774286628
## 15      7.043352    6.910649 1.53570664 1.5582311     0.809782624
## 16      7.005382    6.896619 1.48792338 1.4725204     0.798950732
## 17      6.955821    6.826179 1.46378076 1.4623127     0.818091869
## 18      6.923686    6.802314 1.74194360 1.4575837     0.845089495
## 19      6.783792    6.644209 1.44163394 1.4964601     0.805335939
## 20      6.739251    6.564749 1.25278461 1.2840250     0.819479704
## 21      6.722047    6.573952 1.62634337 1.2664102     0.726798236
## 22      6.725470    6.544531 1.10735321 1.4313060     0.616552353
## 23      6.683862    6.534138 1.35268235 1.4338852     0.754444003
## 24      6.690085    6.507915 1.18529546 1.4404511     0.695137084
## 25      6.671149    6.484851 1.15318382 1.2108622     0.709978998
## 26      6.636723    6.507277 1.69227767 1.3538144     0.949492395
## 27      6.598397    6.455603 1.34327984 1.4884117     0.821944237
## 28      6.545906    6.362094 1.21755970 1.4122279     0.719216824
## 29      6.566874    6.341126 0.87200195 1.2555852     0.540239990
## 30      6.557131    6.346870 1.23374844 1.3731925     0.706156135
## 31      6.515768    6.368232 1.43092346 1.3877769     0.844465852
## 32      6.509117    6.338883 1.12786877 1.4257925     0.647239029
## 33      6.494596    6.349404 1.43362653 1.3845654     0.793984234
## 34      6.471055    6.334945 1.38439786 1.5320909     0.888960600
## 35      6.568477    6.181523 1.87076569 1.2742969     0.710098088
## 36      6.452020    6.261980 1.07062232 1.4021829     0.595027924
## 37      6.444167    6.243833 1.53062356 1.2866776     0.590148330
## 38      6.381534    5.954467 1.36135590 1.3802285     0.519983292
## 39      6.191957    6.018043 1.63295245 1.2596987     0.632105708
## 40      6.177348    6.018652 1.32539356 1.5050592     0.712732911
## 41      6.178989    5.995011 1.48841226 1.3231105     0.653133035
## 42      6.179980    5.988021 1.29121542 1.2846460     0.618784428
## 43      6.186584    5.955417 0.73729920 1.2872157     0.653095961
## 44      6.105848    5.910152 1.00082040 1.2861688     0.685636222
## 45      6.108635    5.897364 0.90978450 1.1821251     0.596018553
## 46      6.053908    5.892092 1.29178786 1.4457120     0.699475348
## 47      6.065538    5.876463 0.78644109 1.5489691     0.498272628
## 48      6.042737    5.885264 1.39506662 1.4449233     0.853144348
## 49      6.030275    5.895725 1.28177810 1.4692824     0.547349334
## 50      6.197242    5.714757 0.90797532 1.0814178     0.450191766
## 51      5.990719    5.849281 1.41691518 1.4363378     0.913475871
## 52      5.982670    5.821330 1.31458235 1.4735161     0.628949940
## 53      5.978286    5.765714 1.09186447 1.1462175     0.617584646
## 54      5.920264    5.779736 1.26074862 1.4047149     0.638566971
## 55      5.922559    5.753441 1.40167844 1.1282744     0.900214076
## 56      5.908371    5.767629 0.72887063 1.2518256     0.589465201
## 57      5.919694    5.730305 1.21768391 1.1500913     0.685158312
## 58      5.903977    5.742023 0.83375657 1.2276191     0.473630250
## 59      5.885181    5.758819 1.13077676 1.4931492     0.437726080
## 60      5.903642    5.734358 1.28455627 1.3843690     0.606041551
## 61      5.897366    5.722633 1.34691131 1.1863034     0.834647238
## 62      5.842225    5.673775 1.34120595 1.4525188     0.790828228
## 63      5.811947    5.618054 1.03522527 1.2187704     0.630166113
## 64      5.729862    5.528138 1.18939555 1.2095610     0.638007462
## 65      5.714693    5.527307 1.35593808 1.1313633     0.844714701
## 66      5.688140    5.533860 1.32087934 1.4766711     0.695168316
## 67      5.646114    5.491885 1.15655756 1.4449452     0.637714267
## 68      5.676954    5.373046 1.10180306 1.3575643     0.520169020
## 69      5.594865    5.405135 1.19827437 1.3377532     0.637605608
## 70      5.577381    5.408619 0.93253732 1.5072849     0.579250693
## 71      5.549594    5.394406 1.55167484 1.2627909     0.943062425
## 72      5.545335    5.314665 0.85769922 1.2539176     0.468009055
## 73      5.491570    5.298430 1.06931758 1.2581898     0.650784671
## 74      5.448410    5.223590 0.99101239 1.2390889     0.604590058
## 75      5.403040    5.244960 1.28601193 1.3431331     0.687763453
## 76      5.581399    5.040601 0.92557931 1.3682181     0.641022384
## 77      5.391777    5.194223 1.22255623 0.9679830     0.701288521
## 78      5.364848    5.193152 0.95148438 1.1378535     0.541452050
## 79      5.319278    5.226721 1.08116579 1.1608374     0.741415501
## 80      5.359984    5.178016 0.72688353 0.6726907     0.402047783
## 81      5.352889    5.171112 0.99553859 1.2744447     0.492345721
## 82      5.370032    5.129968 1.12843120 1.4313376     0.617144227
## 83      5.341044    5.132956 1.12112904 1.2383765     0.667464674
## 84      5.318341    5.151659 0.87811458 0.7748644     0.597710669
## 85      5.299287    5.168714 1.15360177 1.1524003     0.540775776
## 86      5.349061    5.110939 1.07937384 1.4024167     0.574873745
## 87      5.325246    5.128754 1.28948748 1.2394146     0.810198903
## 88      5.318882    5.131118 1.07498753 1.1296242     0.735081077
## 89      5.285042    5.104959 1.31517529 1.3670430     0.795843542
## 90      5.276336    5.087665 0.98240942 1.0693359     0.705186307
## 91      5.301583    5.060418 0.73057312 1.1439450     0.582569480
## 92      5.272173    5.077828 1.06457794 1.2078930     0.644948184
## 93      5.242484    5.059516 0.02264318 0.7211514     0.113989137
## 94      5.147281    5.000719 0.78854758 1.2774913     0.652168989
## 95      5.209500    4.938500 0.78375626 1.2157705     0.056915730
## 96      5.111426    4.970574 0.52471364 1.2714633     0.529235125
## 97      5.079335    4.942666 0.88541639 1.3401265     0.495879292
## 98      5.089920    4.918080 0.59622008 1.3942386     0.553457797
## 99      5.067356    4.856644 0.47982019 1.1792833     0.504130781
## 100     5.021680    4.888320 1.02723587 1.4930112     0.557783484
## 101     4.929435    4.728565 1.05469871 1.3847886     0.187080070
## 102     4.884367    4.725633 1.00726581 0.8683515     0.613212049
## 103     4.881848    4.668152 0.71624923 1.1556472     0.565666974
## 104     4.825134    4.644866 0.98970181 0.9974714     0.520187259
## 105     4.803695    4.624306 1.16145909 1.4343795     0.708217680
## 106     4.850643    4.567357 0.36842093 0.9841360     0.005564754
## 107     4.796541    4.593459 0.56430537 0.9460182     0.132892117
## 108     4.798225    4.585775 1.15687311 0.7115512     0.639333189
## 109     4.752464    4.535536 0.99619275 0.8036852     0.731159747
## 110     4.689822    4.526178 0.58668298 0.7351317     0.533241034
## 111     4.770355    4.377645 0.96443433 1.0984708     0.338611811
## 112     4.655692    4.450308 0.56047946 1.0679507     0.309988350
## 113     4.774102    4.325898 0.23430565 0.8707010     0.106654435
## 114     4.614740    4.475260 0.36711055 1.1232359     0.397522569
## 115     4.601604    4.468396 0.47930902 1.1796919     0.409362853
## 116     4.644106    4.383894 0.63640678 1.0031873     0.257835895
## 117     4.622591    4.371409 1.10271049 0.9786132     0.501180470
## 118     4.557362    4.372639 1.19821024 1.1556202     0.356578588
## 119     4.542729    4.377271 0.33923385 0.8646692     0.353409708
## 120     4.553447    4.326553 1.00985014 1.2599764     0.625130832
## 121     4.466735    4.285265 0.90059674 1.0074837     0.637524426
## 122     4.371522    4.258478 0.79222125 0.7543726     0.455427617
## 123     4.377164    4.206836 0.64845729 1.2720308     0.285349280
## 124     4.410054    4.171946 0.80896425 0.8320444     0.289957434
## 125     4.374934    4.197066 0.95061266 0.5706149     0.649546981
## 126     4.357811    4.202190 0.09210235 1.2290235     0.191407025
## 127     4.269671    4.110329 0.47618049 1.2814734     0.169365674
## 128     4.275183    4.084817 0.60304892 0.9047800     0.048642170
## 129     4.278518    4.057483 0.60176510 1.0062383     0.429783404
## 130     4.345747    3.932253 0.65951669 1.2140086     0.290920824
## 131     4.222707    4.017293 0.66722482 0.8736647     0.295637727
## 132     4.185410    4.006590 0.89465195 1.3945376     0.575903952
## 133     4.195800    3.966200 0.38143072 1.1298277     0.217632607
## 134     4.124059    3.939941 0.35022771 1.0432800     0.215844259
## 135     4.111947    3.944053 0.16192533 0.9930250     0.268505007
## 136     4.077479    3.862521 0.23344204 0.5125688     0.315089583
## 137     4.034712    3.837289 0.43801299 0.9538559     0.041134715
## 138     3.978700    3.771300 0.37584653 1.0830959     0.196763754
## 139     4.044344    3.571656 0.52102125 1.1900952     0.000000000
## 140     3.951642    3.638358 0.85842818 1.1044120     0.049868666
## 141     3.873661    3.714338 0.40147722 0.5815433     0.180746779
## 142     3.874123    3.657877 1.12209415 1.2215550     0.341755509
## 143     3.745784    3.568217 0.43108541 0.4352998     0.209930211
## 144     3.714319    3.573681 0.30580869 0.9130204     0.375223309
## 145     3.734715    3.471285 0.36861026 0.6404498     0.277321130
## 146     3.692750    3.493250 0.59168345 0.9353822     0.310080916
## 147     3.725539    3.456462 0.39724863 0.6013231     0.163486004
## 148     3.653756    3.412244 0.11904179 0.8721179     0.229918197
## 149     3.584428    3.429572 0.24454993 0.7912447     0.194129139
## 150     3.594038    3.395962 0.30544472 0.4318825     0.247105569
## 151     3.543030    3.398970 0.36874589 0.9457070     0.326424807
## 152     3.663669    3.260331 0.77715313 0.3961026     0.500533342
## 153     3.461430    3.236570 0.51113588 1.0419898     0.364509284
## 154     3.074690    2.735310 0.09162257 0.6297936     0.151610792
## 155     2.864884    2.521116 0.00000000 0.0000000     0.018772686
##        freedom generosity  corruption  dystopia
## 1   0.63542259 0.36201224 0.315963835 2.2770267
## 2   0.62600672 0.35528049 0.400770068 2.3137074
## 3   0.62716264 0.47554022 0.153526559 2.3227153
## 4   0.62007058 0.29054928 0.367007285 2.2767162
## 5   0.61795086 0.24548277 0.382611543 2.4301815
## 6   0.58538449 0.47048983 0.282661825 2.2948041
## 7   0.61110091 0.43553972 0.287371516 2.1872644
## 8   0.61406213 0.50000513 0.382816702 2.0464563
## 9   0.61292410 0.38539925 0.384398729 2.0975380
## 10  0.60160738 0.47769925 0.301183730 2.0652108
## 11  0.40598860 0.33008265 0.085242100 2.8017573
## 12  0.58013165 0.21461323 0.100106589 2.8986392
## 13  0.56776619 0.31647232 0.221060365 2.1385064
## 14  0.50574052 0.39257878 0.135638788 2.2181134
## 15  0.57311034 0.42785832 0.298388153 1.7738690
## 16  0.56251138 0.33626917 0.276731938 2.0157700
## 17  0.53977072 0.23150334 0.251343131 2.1242104
## 18  0.59662789 0.28318098 0.318834424 1.6195121
## 19  0.50819004 0.49277416 0.265428066 1.7041435
## 20  0.37689528 0.32666242 0.082287982 2.5095859
## 21  0.60834527 0.36094195 0.324489564 1.7347035
## 22  0.43745375 0.16234989 0.111092761 2.7692671
## 23  0.49094617 0.08810676 0.036872927 2.4518619
## 24  0.49451920 0.10945706 0.059739888 2.6140053
## 25  0.41273001 0.12099043 0.132774115 2.8371549
## 26  0.54984057 0.34596598 0.464307785 1.2163620
## 27  0.58876705 0.57473058 0.153066069 1.5568628
## 28  0.57939225 0.17509693 0.178061873 2.1724095
## 29  0.53131062 0.28348839 0.077223279 2.8938911
## 30  0.55002683 0.21055694 0.070983924 2.3072000
## 31  0.47022212 0.12976231 0.172502428 2.0059547
## 32  0.58020073 0.57212311 0.031612735 2.0395083
## 33  0.36146659 0.25836048 0.063829236 2.1266074
## 34  0.40878123 0.19013357 0.070914097 1.9277577
## 35  0.60413098 0.33047387 0.439299256 1.1454644
## 36  0.47748742 0.14901447 0.046668742 2.6160681
## 37  0.44975057 0.14761601 0.273432255 2.0654297
## 38  0.51863074 0.32529646 0.008964816 2.0532475
## 39  0.49633759 0.22828980 0.215159550 1.6404252
## 40  0.29581746 0.13654448 0.024210852 2.0977767
## 41  0.53674692 0.17266849 0.257042170 1.6561494
## 42  0.40226498 0.41660893 0.065600708 2.0044489
## 43  0.44755185 0.30167422 0.130687982 2.5139306
## 44  0.45519820 0.15011247 0.140134647 2.2903526
## 45  0.43245253 0.07825799 0.089980960 2.7145939
## 46  0.52034211 0.15846597 0.059307806 1.7977228
## 47  0.65824866 0.41598365 0.246528223 1.8169136
## 48  0.25645071 0.17278965 0.028028091 1.8133121
## 49  0.37378311 0.05226382 0.032962881 2.2056074
## 50  0.54750937 0.24001564 0.096581072 2.6319556
## 51  0.50562555 0.12057277 0.163760737 1.3632236
## 52  0.23423178 0.01016466 0.011865643 2.2284405
## 53  0.23333581 0.06943665 0.146096110 2.5676038
## 54  0.32570791 0.15307479 0.073842727 1.9936552
## 55  0.25792167 0.20667437 0.063282669 1.8803780
## 56  0.24072905 0.20877913 0.010091286 2.8078084
## 57  0.45700374 0.13351992 0.004387901 2.1768315
## 58  0.55873293 0.22556072 0.060477726 2.4432790
## 59  0.41827193 0.24992499 0.259270340 1.8329098
## 60  0.43745428 0.20196442 0.119282886 1.7848926
## 61  0.47120363 0.26684570 0.155353352 1.5491576
## 62  0.57257581 0.24264909 0.045128979 1.3133173
## 63  0.45000288 0.12681971 0.047049087 2.2072694
## 64  0.49124733 0.36093375 0.042181555 1.6975839
## 65  0.35511154 0.27125430 0.041237976 1.6212492
## 66  0.47913143 0.09889081 0.183248922 1.3575087
## 67  0.29540026 0.15513751 0.156313822 1.7232330
## 68  0.46573323 0.15207367 0.092610210 1.8350112
## 69  0.30074060 0.04669304 0.099671580 1.8792779
## 70  0.47350779 0.22415066 0.091065913 1.6853335
## 71  0.49096864 0.37446579 0.293933749 0.5546331
## 72  0.58521467 0.19351342 0.099331893 1.9726048
## 73  0.20871553 0.22012588 0.040903781 1.9470844
## 74  0.41842115 0.17217046 0.119803272 1.7911766
## 75  0.17586352 0.07840166 0.036636937 1.7164593
## 76  0.47430724 0.23381834 0.055267781 1.6123257
## 77  0.25577229 0.24800298 0.043103110 1.8544924
## 78  0.26028794 0.31993145 0.057471618 2.0105407
## 79  0.47278771 0.02880684 0.022794275 1.7649386
## 80  0.23521526 0.31544602 0.124348067 2.7924893
## 81  0.44332346 0.61170459 0.015317135 1.4294770
## 82  0.15399712 0.06501963 0.064491123 1.7894638
## 83  0.19498906 0.19791102 0.088174194 1.7291915
## 84  0.40815833 0.03220996 0.087763183 2.4561894
## 85  0.39815584 0.04526934 0.180987507 1.7624817
## 86  0.55258983 0.18696785 0.113945253 1.3194652
## 87  0.09573125 0.00000000 0.043289777 1.7492216
## 88  0.28851599 0.26445076 0.037513830 1.6950738
## 89  0.49846530 0.09510271 0.015869452 1.1076827
## 90  0.20440318 0.32886750 0.000000000 1.8921726
## 91  0.34807986 0.23618887 0.073345453 2.0658112
## 92  0.32590598 0.25376096 0.060277794 1.6174693
## 93  0.60212696 0.29163131 0.282410324 3.1174846
## 94  0.57105559 0.23496805 0.087633237 1.4623187
## 95  0.39495257 0.23094720 0.026121566 2.3653905
## 96  0.47156671 0.24899764 0.146377146 1.8490493
## 97  0.50153768 0.47405455 0.173380390 1.1401844
## 98  0.45494339 0.42858037 0.039439179 1.5367231
## 99  0.44030595 0.39409617 0.072975546 1.8912411
## 100 0.39414397 0.33846423 0.032902289 1.1112924
## 101 0.47924674 0.13936238 0.072509497 1.5109086
## 102 0.28968069 0.04969336 0.086723149 1.8902512
## 103 0.25471106 0.11417317 0.089282602 1.8788903
## 104 0.28211015 0.12863144 0.114381365 1.7021611
## 105 0.28923172 0.11317769 0.011051531 0.9961393
## 106 0.31869769 0.29304090 0.071095176 2.6684599
## 107 0.43038875 0.23629846 0.051306631 2.3336456
## 108 0.24932261 0.38724291 0.048761073 1.4987350
## 109 0.38149863 0.20131294 0.039864216 1.4904416
## 110 0.47835666 0.17225535 0.123717859 1.9787362
## 111 0.52030355 0.07713374 0.093146972 1.4818902
## 112 0.45276377 0.44486031 0.064641319 1.6519022
## 113 0.48079109 0.32222810 0.179436386 2.3556509
## 114 0.51449203 0.83807516 0.188816205 1.1152904
## 115 0.37792227 0.18346889 0.115460448 1.7896461
## 116 0.46160349 0.24958014 0.078213550 1.8267055
## 117 0.28855553 0.19963726 0.107215755 1.3189073
## 118 0.31232858 0.04378538 0.076046787 1.3229163
## 119 0.40884274 0.31265074 0.165455714 2.0157437
## 120 0.56121325 0.49086356 0.073653966 0.4193892
## 121 0.19830327 0.08348809 0.026674422 1.5214992
## 122 0.46998700 0.23153849 0.092226885 1.5191171
## 123 0.09609804 0.20187002 0.136957005 1.6516373
## 124 0.43502587 0.12085213 0.079618134 1.7241356
## 125 0.30941004 0.05400882 0.251666635 1.5001378
## 126 0.23596135 0.24645583 0.060241356 2.2249587
## 127 0.30661374 0.18335420 0.104970247 1.6681910
## 128 0.44770619 0.20123747 0.130061775 1.8449643
## 129 0.63337582 0.38592297 0.068105951 1.0429411
## 130 0.01499586 0.18231745 0.089847520 1.6870658
## 131 0.42302629 0.25692394 0.025336370 1.5778675
## 132 0.12297478 0.27006146 0.023029471 0.8143823
## 133 0.44318596 0.32576606 0.057069719 1.5263627
## 134 0.32436785 0.25086468 0.120328106 1.7272129
## 135 0.36365870 0.22867385 0.138572946 1.8739834
## 136 0.46691465 0.28717047 0.072711654 2.0817862
## 137 0.16234203 0.21611385 0.053581882 2.0712380
## 138 0.33638421 0.18914349 0.095375381 1.5979702
## 139 0.39066130 0.15749727 0.119094640 1.4298353
## 140 0.00000000 0.09792649 0.069720335 1.6144824
## 141 0.10617952 0.31187093 0.061157830 2.1508012
## 142 0.50519633 0.09934845 0.098583199 0.3779137
## 143 0.42596278 0.20794846 0.060929015 1.8856310
## 144 0.18919677 0.20873253 0.067231975 1.5846126
## 145 0.03036986 0.48920378 0.099872150 1.6971676
## 146 0.24946372 0.10412521 0.056767423 1.3456006
## 147 0.14706244 0.28567082 0.116793513 1.8795674
## 148 0.33288118 0.26654989 0.038948249 1.6732860
## 149 0.34858751 0.26481509 0.110937618 1.5523119
## 150 0.38042614 0.19689615 0.095665015 1.8372293
## 151 0.58184385 0.25275603 0.455220014 0.5400612
## 152 0.08153944 0.49366373 0.151347131 1.0615735
## 153 0.39001778 0.35425636 0.066035107 0.6211305
## 154 0.05990075 0.20443518 0.084147945 1.6830242
## 155 0.27084205 0.28087649 0.056565076 2.0660048
```

# Summary statistics


```r
y17_full %>% 
  group_by(region) %>% 
  select(region, rank, score, gdp, life_expectancy, corruption) %>% 
  summarise(rank = mean(rank), score = mean(score), gdp = mean(gdp), life_expectancy = mean(life_expectancy), corruption = mean(corruption)) %>% 
  arrange(rank)
```

```
## # A tibble: 10 x 6
##    region                      rank score   gdp life_expectancy corruption
##    <chr>                      <dbl> <dbl> <dbl>           <dbl>      <dbl>
##  1 Australia and New Zealand   9.00  7.30 1.45            0.830     0.342 
##  2 North America              10.5   7.15 1.51            0.804     0.212 
##  3 Western Europe             27.1   6.70 1.46            0.825     0.219 
##  4 Latin America and Caribb…  50.8   5.96 1.01            0.611     0.0878
##  5 Eastern Asia               64.8   5.65 1.32            0.808     0.107 
##  6 Southeastern Asia          73.8   5.44 0.965           0.582     0.128 
##  7 Central and Eastern Euro…  75.1   5.41 1.09            0.636     0.0796
##  8 Middle East and Northern…  76.4   5.37 1.17            0.606     0.149 
##  9 Southern Asia             110.    4.63 0.697           0.457     0.103 
## 10 Sub-Saharan Africa        128.    4.11 0.502           0.225     0.101
```

```r
y17_full
```

```
##                      country                          region rank score
## 1                     Norway                  Western Europe    1 7.537
## 2                    Denmark                  Western Europe    2 7.522
## 3                    Iceland                  Western Europe    3 7.504
## 4                Switzerland                  Western Europe    4 7.494
## 5                    Finland                  Western Europe    5 7.469
## 6                Netherlands                  Western Europe    6 7.377
## 7                     Canada                   North America    7 7.316
## 8                New Zealand       Australia and New Zealand    8 7.314
## 9                     Sweden                  Western Europe    9 7.284
## 10                 Australia       Australia and New Zealand   10 7.284
## 11                    Israel Middle East and Northern Africa   11 7.213
## 12                Costa Rica     Latin America and Caribbean   12 7.079
## 13                   Austria                  Western Europe   13 7.006
## 14             United States                   North America   14 6.993
## 15                   Ireland                  Western Europe   15 6.977
## 16                   Germany                  Western Europe   16 6.951
## 17                   Belgium                  Western Europe   17 6.891
## 18                Luxembourg                  Western Europe   18 6.863
## 19            United Kingdom                  Western Europe   19 6.714
## 20                     Chile     Latin America and Caribbean   20 6.652
## 21      United Arab Emirates Middle East and Northern Africa   21 6.648
## 22                    Brazil     Latin America and Caribbean   22 6.635
## 23            Czech Republic      Central and Eastern Europe   23 6.609
## 24                 Argentina     Latin America and Caribbean   24 6.599
## 25                    Mexico     Latin America and Caribbean   25 6.578
## 26                 Singapore               Southeastern Asia   26 6.572
## 27                     Malta                  Western Europe   27 6.527
## 28                   Uruguay     Latin America and Caribbean   28 6.454
## 29                 Guatemala     Latin America and Caribbean   29 6.454
## 30                    Panama     Latin America and Caribbean   30 6.452
## 31                    France                  Western Europe   31 6.442
## 32                  Thailand               Southeastern Asia   32 6.424
## 33  Taiwan Province of China                    Eastern Asia   33 6.422
## 34                     Spain                  Western Europe   34 6.403
## 35                     Qatar Middle East and Northern Africa   35 6.375
## 36                  Colombia     Latin America and Caribbean   36 6.357
## 37              Saudi Arabia Middle East and Northern Africa   37 6.344
## 38       Trinidad and Tobago     Latin America and Caribbean   38 6.168
## 39                    Kuwait Middle East and Northern Africa   39 6.105
## 40                  Slovakia      Central and Eastern Europe   40 6.098
## 41                   Bahrain Middle East and Northern Africa   41 6.087
## 42                  Malaysia               Southeastern Asia   42 6.084
## 43                 Nicaragua     Latin America and Caribbean   43 6.071
## 44                   Ecuador     Latin America and Caribbean   44 6.008
## 45               El Salvador     Latin America and Caribbean   45 6.003
## 46                    Poland      Central and Eastern Europe   46 5.973
## 47                Uzbekistan      Central and Eastern Europe   47 5.971
## 48                     Italy                  Western Europe   48 5.964
## 49                    Russia      Central and Eastern Europe   49 5.963
## 50                    Belize     Latin America and Caribbean   50 5.956
## 51                     Japan                    Eastern Asia   51 5.920
## 52                 Lithuania      Central and Eastern Europe   52 5.902
## 53                   Algeria Middle East and Northern Africa   53 5.872
## 54                    Latvia      Central and Eastern Europe   54 5.850
## 55               South Korea                    Eastern Asia   55 5.838
## 56                   Moldova      Central and Eastern Europe   56 5.838
## 57                   Romania      Central and Eastern Europe   57 5.825
## 58                   Bolivia     Latin America and Caribbean   58 5.823
## 59              Turkmenistan      Central and Eastern Europe   59 5.822
## 60                Kazakhstan      Central and Eastern Europe   60 5.819
## 61              North Cyprus                  Western Europe   61 5.810
## 62                  Slovenia      Central and Eastern Europe   62 5.758
## 63                      Peru     Latin America and Caribbean   63 5.715
## 64                 Mauritius              Sub-Saharan Africa   64 5.629
## 65                    Cyprus                  Western Europe   65 5.621
## 66                   Estonia      Central and Eastern Europe   66 5.611
## 67                   Belarus      Central and Eastern Europe   67 5.569
## 68                     Libya Middle East and Northern Africa   68 5.525
## 69                    Turkey Middle East and Northern Africa   69 5.500
## 70                  Paraguay     Latin America and Caribbean   70 5.493
## 71   Hong Kong S.A.R., China                    Eastern Asia   71 5.472
## 72               Philippines               Southeastern Asia   72 5.430
## 73                    Serbia      Central and Eastern Europe   73 5.395
## 74                    Jordan Middle East and Northern Africa   74 5.336
## 75                   Hungary      Central and Eastern Europe   75 5.324
## 76                   Jamaica     Latin America and Caribbean   76 5.311
## 77                   Croatia      Central and Eastern Europe   77 5.293
## 78                    Kosovo      Central and Eastern Europe   78 5.279
## 79                     China                    Eastern Asia   79 5.273
## 80                  Pakistan                   Southern Asia   80 5.269
## 81                 Indonesia               Southeastern Asia   81 5.262
## 82                 Venezuela     Latin America and Caribbean   82 5.250
## 83                Montenegro      Central and Eastern Europe   83 5.237
## 84                   Morocco Middle East and Northern Africa   84 5.235
## 85                Azerbaijan      Central and Eastern Europe   85 5.234
## 86        Dominican Republic     Latin America and Caribbean   86 5.230
## 87                    Greece                  Western Europe   87 5.227
## 88                   Lebanon Middle East and Northern Africa   88 5.225
## 89                  Portugal                  Western Europe   89 5.195
## 90    Bosnia and Herzegovina      Central and Eastern Europe   90 5.182
## 91                  Honduras     Latin America and Caribbean   91 5.181
## 92                 Macedonia      Central and Eastern Europe   92 5.175
## 93                   Somalia              Sub-Saharan Africa   93 5.151
## 94                   Vietnam               Southeastern Asia   94 5.074
## 95                   Nigeria              Sub-Saharan Africa   95 5.074
## 96                Tajikistan      Central and Eastern Europe   96 5.041
## 97                    Bhutan                   Southern Asia   97 5.011
## 98                Kyrgyzstan      Central and Eastern Europe   98 5.004
## 99                     Nepal                   Southern Asia   99 4.962
## 100                 Mongolia                    Eastern Asia  100 4.955
## 101             South Africa              Sub-Saharan Africa  101 4.829
## 102                  Tunisia Middle East and Northern Africa  102 4.805
## 103  Palestinian Territories Middle East and Northern Africa  103 4.775
## 104                    Egypt Middle East and Northern Africa  104 4.735
## 105                 Bulgaria      Central and Eastern Europe  105 4.714
## 106             Sierra Leone              Sub-Saharan Africa  106 4.709
## 107                 Cameroon              Sub-Saharan Africa  107 4.695
## 108                     Iran Middle East and Northern Africa  108 4.692
## 109                  Albania      Central and Eastern Europe  109 4.644
## 110               Bangladesh                   Southern Asia  110 4.608
## 111                  Namibia              Sub-Saharan Africa  111 4.574
## 112                    Kenya              Sub-Saharan Africa  112 4.553
## 113               Mozambique              Sub-Saharan Africa  113 4.550
## 114                  Myanmar               Southeastern Asia  114 4.545
## 115                  Senegal              Sub-Saharan Africa  115 4.535
## 116                   Zambia              Sub-Saharan Africa  116 4.514
## 117                     Iraq Middle East and Northern Africa  117 4.497
## 118                    Gabon              Sub-Saharan Africa  118 4.465
## 119                 Ethiopia              Sub-Saharan Africa  119 4.460
## 120                Sri Lanka                   Southern Asia  120 4.440
## 121                  Armenia      Central and Eastern Europe  121 4.376
## 122                    India                   Southern Asia  122 4.315
## 123               Mauritania              Sub-Saharan Africa  123 4.292
## 124      Congo (Brazzaville)              Sub-Saharan Africa  124 4.291
## 125                  Georgia      Central and Eastern Europe  125 4.286
## 126         Congo (Kinshasa)              Sub-Saharan Africa  126 4.280
## 127                     Mali              Sub-Saharan Africa  127 4.190
## 128              Ivory Coast              Sub-Saharan Africa  128 4.180
## 129                 Cambodia               Southeastern Asia  129 4.168
## 130                    Sudan              Sub-Saharan Africa  130 4.139
## 131                    Ghana              Sub-Saharan Africa  131 4.120
## 132                  Ukraine      Central and Eastern Europe  132 4.096
## 133                   Uganda              Sub-Saharan Africa  133 4.081
## 134             Burkina Faso              Sub-Saharan Africa  134 4.032
## 135                    Niger              Sub-Saharan Africa  135 4.028
## 136                   Malawi              Sub-Saharan Africa  136 3.970
## 137                     Chad              Sub-Saharan Africa  137 3.936
## 138                 Zimbabwe              Sub-Saharan Africa  138 3.875
## 139                  Lesotho              Sub-Saharan Africa  139 3.808
## 140                   Angola              Sub-Saharan Africa  140 3.795
## 141              Afghanistan                   Southern Asia  141 3.794
## 142                 Botswana              Sub-Saharan Africa  142 3.766
## 143                    Benin              Sub-Saharan Africa  143 3.657
## 144               Madagascar              Sub-Saharan Africa  144 3.644
## 145                    Haiti     Latin America and Caribbean  145 3.603
## 146                    Yemen Middle East and Northern Africa  146 3.593
## 147              South Sudan              Sub-Saharan Africa  147 3.591
## 148                  Liberia              Sub-Saharan Africa  148 3.533
## 149                   Guinea              Sub-Saharan Africa  149 3.507
## 150                     Togo              Sub-Saharan Africa  150 3.495
## 151                   Rwanda              Sub-Saharan Africa  151 3.471
## 152                    Syria Middle East and Northern Africa  152 3.462
## 153                 Tanzania              Sub-Saharan Africa  153 3.349
## 154                  Burundi              Sub-Saharan Africa  154 2.905
## 155 Central African Republic              Sub-Saharan Africa  155 2.693
##     whisker_high whisker_low        gdp    family life_expectancy
## 1       7.594445    7.479556 1.61646318 1.5335236     0.796666503
## 2       7.581728    7.462272 1.48238301 1.5511216     0.792565525
## 3       7.622030    7.385970 1.48063302 1.6105740     0.833552122
## 4       7.561772    7.426227 1.56497955 1.5169117     0.858131289
## 5       7.527542    7.410458 1.44357193 1.5402467     0.809157670
## 6       7.427426    7.326574 1.50394464 1.4289392     0.810696125
## 7       7.384403    7.247597 1.47920442 1.4813490     0.834557652
## 8       7.379510    7.248490 1.40570605 1.5481951     0.816759706
## 9       7.344095    7.223905 1.49438727 1.4781622     0.830875158
## 10      7.356651    7.211349 1.48441494 1.5100420     0.843886793
## 11      7.279853    7.146146 1.37538242 1.3762900     0.838404000
## 12      7.168112    6.989888 1.10970628 1.4164037     0.759509265
## 13      7.070670    6.941330 1.48709726 1.4599450     0.815328419
## 14      7.074657    6.911343 1.54625928 1.4199206     0.774286628
## 15      7.043352    6.910649 1.53570664 1.5582311     0.809782624
## 16      7.005382    6.896619 1.48792338 1.4725204     0.798950732
## 17      6.955821    6.826179 1.46378076 1.4623127     0.818091869
## 18      6.923686    6.802314 1.74194360 1.4575837     0.845089495
## 19      6.783792    6.644209 1.44163394 1.4964601     0.805335939
## 20      6.739251    6.564749 1.25278461 1.2840250     0.819479704
## 21      6.722047    6.573952 1.62634337 1.2664102     0.726798236
## 22      6.725470    6.544531 1.10735321 1.4313060     0.616552353
## 23      6.683862    6.534138 1.35268235 1.4338852     0.754444003
## 24      6.690085    6.507915 1.18529546 1.4404511     0.695137084
## 25      6.671149    6.484851 1.15318382 1.2108622     0.709978998
## 26      6.636723    6.507277 1.69227767 1.3538144     0.949492395
## 27      6.598397    6.455603 1.34327984 1.4884117     0.821944237
## 28      6.545906    6.362094 1.21755970 1.4122279     0.719216824
## 29      6.566874    6.341126 0.87200195 1.2555852     0.540239990
## 30      6.557131    6.346870 1.23374844 1.3731925     0.706156135
## 31      6.515768    6.368232 1.43092346 1.3877769     0.844465852
## 32      6.509117    6.338883 1.12786877 1.4257925     0.647239029
## 33      6.494596    6.349404 1.43362653 1.3845654     0.793984234
## 34      6.471055    6.334945 1.38439786 1.5320909     0.888960600
## 35      6.568477    6.181523 1.87076569 1.2742969     0.710098088
## 36      6.452020    6.261980 1.07062232 1.4021829     0.595027924
## 37      6.444167    6.243833 1.53062356 1.2866776     0.590148330
## 38      6.381534    5.954467 1.36135590 1.3802285     0.519983292
## 39      6.191957    6.018043 1.63295245 1.2596987     0.632105708
## 40      6.177348    6.018652 1.32539356 1.5050592     0.712732911
## 41      6.178989    5.995011 1.48841226 1.3231105     0.653133035
## 42      6.179980    5.988021 1.29121542 1.2846460     0.618784428
## 43      6.186584    5.955417 0.73729920 1.2872157     0.653095961
## 44      6.105848    5.910152 1.00082040 1.2861688     0.685636222
## 45      6.108635    5.897364 0.90978450 1.1821251     0.596018553
## 46      6.053908    5.892092 1.29178786 1.4457120     0.699475348
## 47      6.065538    5.876463 0.78644109 1.5489691     0.498272628
## 48      6.042737    5.885264 1.39506662 1.4449233     0.853144348
## 49      6.030275    5.895725 1.28177810 1.4692824     0.547349334
## 50      6.197242    5.714757 0.90797532 1.0814178     0.450191766
## 51      5.990719    5.849281 1.41691518 1.4363378     0.913475871
## 52      5.982670    5.821330 1.31458235 1.4735161     0.628949940
## 53      5.978286    5.765714 1.09186447 1.1462175     0.617584646
## 54      5.920264    5.779736 1.26074862 1.4047149     0.638566971
## 55      5.922559    5.753441 1.40167844 1.1282744     0.900214076
## 56      5.908371    5.767629 0.72887063 1.2518256     0.589465201
## 57      5.919694    5.730305 1.21768391 1.1500913     0.685158312
## 58      5.903977    5.742023 0.83375657 1.2276191     0.473630250
## 59      5.885181    5.758819 1.13077676 1.4931492     0.437726080
## 60      5.903642    5.734358 1.28455627 1.3843690     0.606041551
## 61      5.897366    5.722633 1.34691131 1.1863034     0.834647238
## 62      5.842225    5.673775 1.34120595 1.4525188     0.790828228
## 63      5.811947    5.618054 1.03522527 1.2187704     0.630166113
## 64      5.729862    5.528138 1.18939555 1.2095610     0.638007462
## 65      5.714693    5.527307 1.35593808 1.1313633     0.844714701
## 66      5.688140    5.533860 1.32087934 1.4766711     0.695168316
## 67      5.646114    5.491885 1.15655756 1.4449452     0.637714267
## 68      5.676954    5.373046 1.10180306 1.3575643     0.520169020
## 69      5.594865    5.405135 1.19827437 1.3377532     0.637605608
## 70      5.577381    5.408619 0.93253732 1.5072849     0.579250693
## 71      5.549594    5.394406 1.55167484 1.2627909     0.943062425
## 72      5.545335    5.314665 0.85769922 1.2539176     0.468009055
## 73      5.491570    5.298430 1.06931758 1.2581898     0.650784671
## 74      5.448410    5.223590 0.99101239 1.2390889     0.604590058
## 75      5.403040    5.244960 1.28601193 1.3431331     0.687763453
## 76      5.581399    5.040601 0.92557931 1.3682181     0.641022384
## 77      5.391777    5.194223 1.22255623 0.9679830     0.701288521
## 78      5.364848    5.193152 0.95148438 1.1378535     0.541452050
## 79      5.319278    5.226721 1.08116579 1.1608374     0.741415501
## 80      5.359984    5.178016 0.72688353 0.6726907     0.402047783
## 81      5.352889    5.171112 0.99553859 1.2744447     0.492345721
## 82      5.370032    5.129968 1.12843120 1.4313376     0.617144227
## 83      5.341044    5.132956 1.12112904 1.2383765     0.667464674
## 84      5.318341    5.151659 0.87811458 0.7748644     0.597710669
## 85      5.299287    5.168714 1.15360177 1.1524003     0.540775776
## 86      5.349061    5.110939 1.07937384 1.4024167     0.574873745
## 87      5.325246    5.128754 1.28948748 1.2394146     0.810198903
## 88      5.318882    5.131118 1.07498753 1.1296242     0.735081077
## 89      5.285042    5.104959 1.31517529 1.3670430     0.795843542
## 90      5.276336    5.087665 0.98240942 1.0693359     0.705186307
## 91      5.301583    5.060418 0.73057312 1.1439450     0.582569480
## 92      5.272173    5.077828 1.06457794 1.2078930     0.644948184
## 93      5.242484    5.059516 0.02264318 0.7211514     0.113989137
## 94      5.147281    5.000719 0.78854758 1.2774913     0.652168989
## 95      5.209500    4.938500 0.78375626 1.2157705     0.056915730
## 96      5.111426    4.970574 0.52471364 1.2714633     0.529235125
## 97      5.079335    4.942666 0.88541639 1.3401265     0.495879292
## 98      5.089920    4.918080 0.59622008 1.3942386     0.553457797
## 99      5.067356    4.856644 0.47982019 1.1792833     0.504130781
## 100     5.021680    4.888320 1.02723587 1.4930112     0.557783484
## 101     4.929435    4.728565 1.05469871 1.3847886     0.187080070
## 102     4.884367    4.725633 1.00726581 0.8683515     0.613212049
## 103     4.881848    4.668152 0.71624923 1.1556472     0.565666974
## 104     4.825134    4.644866 0.98970181 0.9974714     0.520187259
## 105     4.803695    4.624306 1.16145909 1.4343795     0.708217680
## 106     4.850643    4.567357 0.36842093 0.9841360     0.005564754
## 107     4.796541    4.593459 0.56430537 0.9460182     0.132892117
## 108     4.798225    4.585775 1.15687311 0.7115512     0.639333189
## 109     4.752464    4.535536 0.99619275 0.8036852     0.731159747
## 110     4.689822    4.526178 0.58668298 0.7351317     0.533241034
## 111     4.770355    4.377645 0.96443433 1.0984708     0.338611811
## 112     4.655692    4.450308 0.56047946 1.0679507     0.309988350
## 113     4.774102    4.325898 0.23430565 0.8707010     0.106654435
## 114     4.614740    4.475260 0.36711055 1.1232359     0.397522569
## 115     4.601604    4.468396 0.47930902 1.1796919     0.409362853
## 116     4.644106    4.383894 0.63640678 1.0031873     0.257835895
## 117     4.622591    4.371409 1.10271049 0.9786132     0.501180470
## 118     4.557362    4.372639 1.19821024 1.1556202     0.356578588
## 119     4.542729    4.377271 0.33923385 0.8646692     0.353409708
## 120     4.553447    4.326553 1.00985014 1.2599764     0.625130832
## 121     4.466735    4.285265 0.90059674 1.0074837     0.637524426
## 122     4.371522    4.258478 0.79222125 0.7543726     0.455427617
## 123     4.377164    4.206836 0.64845729 1.2720308     0.285349280
## 124     4.410054    4.171946 0.80896425 0.8320444     0.289957434
## 125     4.374934    4.197066 0.95061266 0.5706149     0.649546981
## 126     4.357811    4.202190 0.09210235 1.2290235     0.191407025
## 127     4.269671    4.110329 0.47618049 1.2814734     0.169365674
## 128     4.275183    4.084817 0.60304892 0.9047800     0.048642170
## 129     4.278518    4.057483 0.60176510 1.0062383     0.429783404
## 130     4.345747    3.932253 0.65951669 1.2140086     0.290920824
## 131     4.222707    4.017293 0.66722482 0.8736647     0.295637727
## 132     4.185410    4.006590 0.89465195 1.3945376     0.575903952
## 133     4.195800    3.966200 0.38143072 1.1298277     0.217632607
## 134     4.124059    3.939941 0.35022771 1.0432800     0.215844259
## 135     4.111947    3.944053 0.16192533 0.9930250     0.268505007
## 136     4.077479    3.862521 0.23344204 0.5125688     0.315089583
## 137     4.034712    3.837289 0.43801299 0.9538559     0.041134715
## 138     3.978700    3.771300 0.37584653 1.0830959     0.196763754
## 139     4.044344    3.571656 0.52102125 1.1900952     0.000000000
## 140     3.951642    3.638358 0.85842818 1.1044120     0.049868666
## 141     3.873661    3.714338 0.40147722 0.5815433     0.180746779
## 142     3.874123    3.657877 1.12209415 1.2215550     0.341755509
## 143     3.745784    3.568217 0.43108541 0.4352998     0.209930211
## 144     3.714319    3.573681 0.30580869 0.9130204     0.375223309
## 145     3.734715    3.471285 0.36861026 0.6404498     0.277321130
## 146     3.692750    3.493250 0.59168345 0.9353822     0.310080916
## 147     3.725539    3.456462 0.39724863 0.6013231     0.163486004
## 148     3.653756    3.412244 0.11904179 0.8721179     0.229918197
## 149     3.584428    3.429572 0.24454993 0.7912447     0.194129139
## 150     3.594038    3.395962 0.30544472 0.4318825     0.247105569
## 151     3.543030    3.398970 0.36874589 0.9457070     0.326424807
## 152     3.663669    3.260331 0.77715313 0.3961026     0.500533342
## 153     3.461430    3.236570 0.51113588 1.0419898     0.364509284
## 154     3.074690    2.735310 0.09162257 0.6297936     0.151610792
## 155     2.864884    2.521116 0.00000000 0.0000000     0.018772686
##        freedom generosity  corruption  dystopia
## 1   0.63542259 0.36201224 0.315963835 2.2770267
## 2   0.62600672 0.35528049 0.400770068 2.3137074
## 3   0.62716264 0.47554022 0.153526559 2.3227153
## 4   0.62007058 0.29054928 0.367007285 2.2767162
## 5   0.61795086 0.24548277 0.382611543 2.4301815
## 6   0.58538449 0.47048983 0.282661825 2.2948041
## 7   0.61110091 0.43553972 0.287371516 2.1872644
## 8   0.61406213 0.50000513 0.382816702 2.0464563
## 9   0.61292410 0.38539925 0.384398729 2.0975380
## 10  0.60160738 0.47769925 0.301183730 2.0652108
## 11  0.40598860 0.33008265 0.085242100 2.8017573
## 12  0.58013165 0.21461323 0.100106589 2.8986392
## 13  0.56776619 0.31647232 0.221060365 2.1385064
## 14  0.50574052 0.39257878 0.135638788 2.2181134
## 15  0.57311034 0.42785832 0.298388153 1.7738690
## 16  0.56251138 0.33626917 0.276731938 2.0157700
## 17  0.53977072 0.23150334 0.251343131 2.1242104
## 18  0.59662789 0.28318098 0.318834424 1.6195121
## 19  0.50819004 0.49277416 0.265428066 1.7041435
## 20  0.37689528 0.32666242 0.082287982 2.5095859
## 21  0.60834527 0.36094195 0.324489564 1.7347035
## 22  0.43745375 0.16234989 0.111092761 2.7692671
## 23  0.49094617 0.08810676 0.036872927 2.4518619
## 24  0.49451920 0.10945706 0.059739888 2.6140053
## 25  0.41273001 0.12099043 0.132774115 2.8371549
## 26  0.54984057 0.34596598 0.464307785 1.2163620
## 27  0.58876705 0.57473058 0.153066069 1.5568628
## 28  0.57939225 0.17509693 0.178061873 2.1724095
## 29  0.53131062 0.28348839 0.077223279 2.8938911
## 30  0.55002683 0.21055694 0.070983924 2.3072000
## 31  0.47022212 0.12976231 0.172502428 2.0059547
## 32  0.58020073 0.57212311 0.031612735 2.0395083
## 33  0.36146659 0.25836048 0.063829236 2.1266074
## 34  0.40878123 0.19013357 0.070914097 1.9277577
## 35  0.60413098 0.33047387 0.439299256 1.1454644
## 36  0.47748742 0.14901447 0.046668742 2.6160681
## 37  0.44975057 0.14761601 0.273432255 2.0654297
## 38  0.51863074 0.32529646 0.008964816 2.0532475
## 39  0.49633759 0.22828980 0.215159550 1.6404252
## 40  0.29581746 0.13654448 0.024210852 2.0977767
## 41  0.53674692 0.17266849 0.257042170 1.6561494
## 42  0.40226498 0.41660893 0.065600708 2.0044489
## 43  0.44755185 0.30167422 0.130687982 2.5139306
## 44  0.45519820 0.15011247 0.140134647 2.2903526
## 45  0.43245253 0.07825799 0.089980960 2.7145939
## 46  0.52034211 0.15846597 0.059307806 1.7977228
## 47  0.65824866 0.41598365 0.246528223 1.8169136
## 48  0.25645071 0.17278965 0.028028091 1.8133121
## 49  0.37378311 0.05226382 0.032962881 2.2056074
## 50  0.54750937 0.24001564 0.096581072 2.6319556
## 51  0.50562555 0.12057277 0.163760737 1.3632236
## 52  0.23423178 0.01016466 0.011865643 2.2284405
## 53  0.23333581 0.06943665 0.146096110 2.5676038
## 54  0.32570791 0.15307479 0.073842727 1.9936552
## 55  0.25792167 0.20667437 0.063282669 1.8803780
## 56  0.24072905 0.20877913 0.010091286 2.8078084
## 57  0.45700374 0.13351992 0.004387901 2.1768315
## 58  0.55873293 0.22556072 0.060477726 2.4432790
## 59  0.41827193 0.24992499 0.259270340 1.8329098
## 60  0.43745428 0.20196442 0.119282886 1.7848926
## 61  0.47120363 0.26684570 0.155353352 1.5491576
## 62  0.57257581 0.24264909 0.045128979 1.3133173
## 63  0.45000288 0.12681971 0.047049087 2.2072694
## 64  0.49124733 0.36093375 0.042181555 1.6975839
## 65  0.35511154 0.27125430 0.041237976 1.6212492
## 66  0.47913143 0.09889081 0.183248922 1.3575087
## 67  0.29540026 0.15513751 0.156313822 1.7232330
## 68  0.46573323 0.15207367 0.092610210 1.8350112
## 69  0.30074060 0.04669304 0.099671580 1.8792779
## 70  0.47350779 0.22415066 0.091065913 1.6853335
## 71  0.49096864 0.37446579 0.293933749 0.5546331
## 72  0.58521467 0.19351342 0.099331893 1.9726048
## 73  0.20871553 0.22012588 0.040903781 1.9470844
## 74  0.41842115 0.17217046 0.119803272 1.7911766
## 75  0.17586352 0.07840166 0.036636937 1.7164593
## 76  0.47430724 0.23381834 0.055267781 1.6123257
## 77  0.25577229 0.24800298 0.043103110 1.8544924
## 78  0.26028794 0.31993145 0.057471618 2.0105407
## 79  0.47278771 0.02880684 0.022794275 1.7649386
## 80  0.23521526 0.31544602 0.124348067 2.7924893
## 81  0.44332346 0.61170459 0.015317135 1.4294770
## 82  0.15399712 0.06501963 0.064491123 1.7894638
## 83  0.19498906 0.19791102 0.088174194 1.7291915
## 84  0.40815833 0.03220996 0.087763183 2.4561894
## 85  0.39815584 0.04526934 0.180987507 1.7624817
## 86  0.55258983 0.18696785 0.113945253 1.3194652
## 87  0.09573125 0.00000000 0.043289777 1.7492216
## 88  0.28851599 0.26445076 0.037513830 1.6950738
## 89  0.49846530 0.09510271 0.015869452 1.1076827
## 90  0.20440318 0.32886750 0.000000000 1.8921726
## 91  0.34807986 0.23618887 0.073345453 2.0658112
## 92  0.32590598 0.25376096 0.060277794 1.6174693
## 93  0.60212696 0.29163131 0.282410324 3.1174846
## 94  0.57105559 0.23496805 0.087633237 1.4623187
## 95  0.39495257 0.23094720 0.026121566 2.3653905
## 96  0.47156671 0.24899764 0.146377146 1.8490493
## 97  0.50153768 0.47405455 0.173380390 1.1401844
## 98  0.45494339 0.42858037 0.039439179 1.5367231
## 99  0.44030595 0.39409617 0.072975546 1.8912411
## 100 0.39414397 0.33846423 0.032902289 1.1112924
## 101 0.47924674 0.13936238 0.072509497 1.5109086
## 102 0.28968069 0.04969336 0.086723149 1.8902512
## 103 0.25471106 0.11417317 0.089282602 1.8788903
## 104 0.28211015 0.12863144 0.114381365 1.7021611
## 105 0.28923172 0.11317769 0.011051531 0.9961393
## 106 0.31869769 0.29304090 0.071095176 2.6684599
## 107 0.43038875 0.23629846 0.051306631 2.3336456
## 108 0.24932261 0.38724291 0.048761073 1.4987350
## 109 0.38149863 0.20131294 0.039864216 1.4904416
## 110 0.47835666 0.17225535 0.123717859 1.9787362
## 111 0.52030355 0.07713374 0.093146972 1.4818902
## 112 0.45276377 0.44486031 0.064641319 1.6519022
## 113 0.48079109 0.32222810 0.179436386 2.3556509
## 114 0.51449203 0.83807516 0.188816205 1.1152904
## 115 0.37792227 0.18346889 0.115460448 1.7896461
## 116 0.46160349 0.24958014 0.078213550 1.8267055
## 117 0.28855553 0.19963726 0.107215755 1.3189073
## 118 0.31232858 0.04378538 0.076046787 1.3229163
## 119 0.40884274 0.31265074 0.165455714 2.0157437
## 120 0.56121325 0.49086356 0.073653966 0.4193892
## 121 0.19830327 0.08348809 0.026674422 1.5214992
## 122 0.46998700 0.23153849 0.092226885 1.5191171
## 123 0.09609804 0.20187002 0.136957005 1.6516373
## 124 0.43502587 0.12085213 0.079618134 1.7241356
## 125 0.30941004 0.05400882 0.251666635 1.5001378
## 126 0.23596135 0.24645583 0.060241356 2.2249587
## 127 0.30661374 0.18335420 0.104970247 1.6681910
## 128 0.44770619 0.20123747 0.130061775 1.8449643
## 129 0.63337582 0.38592297 0.068105951 1.0429411
## 130 0.01499586 0.18231745 0.089847520 1.6870658
## 131 0.42302629 0.25692394 0.025336370 1.5778675
## 132 0.12297478 0.27006146 0.023029471 0.8143823
## 133 0.44318596 0.32576606 0.057069719 1.5263627
## 134 0.32436785 0.25086468 0.120328106 1.7272129
## 135 0.36365870 0.22867385 0.138572946 1.8739834
## 136 0.46691465 0.28717047 0.072711654 2.0817862
## 137 0.16234203 0.21611385 0.053581882 2.0712380
## 138 0.33638421 0.18914349 0.095375381 1.5979702
## 139 0.39066130 0.15749727 0.119094640 1.4298353
## 140 0.00000000 0.09792649 0.069720335 1.6144824
## 141 0.10617952 0.31187093 0.061157830 2.1508012
## 142 0.50519633 0.09934845 0.098583199 0.3779137
## 143 0.42596278 0.20794846 0.060929015 1.8856310
## 144 0.18919677 0.20873253 0.067231975 1.5846126
## 145 0.03036986 0.48920378 0.099872150 1.6971676
## 146 0.24946372 0.10412521 0.056767423 1.3456006
## 147 0.14706244 0.28567082 0.116793513 1.8795674
## 148 0.33288118 0.26654989 0.038948249 1.6732860
## 149 0.34858751 0.26481509 0.110937618 1.5523119
## 150 0.38042614 0.19689615 0.095665015 1.8372293
## 151 0.58184385 0.25275603 0.455220014 0.5400612
## 152 0.08153944 0.49366373 0.151347131 1.0615735
## 153 0.39001778 0.35425636 0.066035107 0.6211305
## 154 0.05990075 0.20443518 0.084147945 1.6830242
## 155 0.27084205 0.28087649 0.056565076 2.0660048
```

# Top 50 countries count by region


```r
top_50 <- head(y17_full, 50)

# unique(top_50$region)
# count <- top_50 %>% 
#   group_by(region) %>%
#   count(region)

count <- count(top_50, region)

count$region <- factor(count$region, levels = count$region[order(-count$n)])

ggplot(count, aes(x = region, y = n, fill = region)) +
  geom_bar(stat = "identity", width = 0.5) +
  guides(fill=FALSE) +
  geom_text(aes(label = n), position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Top 50 countries count by region", y = "Countries count", x = "") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

![](world_happiness_report_files/figure-html/unnamed-chunk-9-1.png)<!-- -->

# Heatmap of Data


```r
library(ggplot2)
library(reshape2)
```

```
## 
## Attaching package: 'reshape2'
```

```
## The following object is masked from 'package:tidyr':
## 
##     smiths
```

```r
data <- y17_full %>%
  select(score, gdp, family, life_expectancy, freedom, generosity, corruption, dystopia)
  
# Create correlation matrix
cordata <- round(cor(data),2)

head(cordata)
```

```
##                 score   gdp family life_expectancy freedom generosity
## score            1.00  0.81   0.75            0.78    0.57       0.16
## gdp              0.81  1.00   0.69            0.84    0.37      -0.02
## family           0.75  0.69   1.00            0.61    0.42       0.05
## life_expectancy  0.78  0.84   0.61            1.00    0.35       0.06
## freedom          0.57  0.37   0.42            0.35    1.00       0.32
## generosity       0.16 -0.02   0.05            0.06    0.32       1.00
##                 corruption dystopia
## score                 0.43     0.48
## gdp                   0.35     0.02
## family                0.23     0.07
## life_expectancy       0.28     0.05
## freedom               0.50     0.08
## generosity            0.29    -0.12
```

```r
# reshape the data correlation values in two axis
melted_cordata <- melt(cordata)
head(melted_cordata)
```

```
##              Var1  Var2 value
## 1           score score  1.00
## 2             gdp score  0.81
## 3          family score  0.75
## 4 life_expectancy score  0.78
## 5         freedom score  0.57
## 6      generosity score  0.16
```

```r
ggplot(data = melted_cordata, aes(Var2, Var1, fill = value, label = value))+
 geom_tile(color = "white") + 
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Correlation") +
  theme_minimal() + 
  labs(title = "Correlation Matrix of Data", x = "", y = "") +
 theme(axis.text.x = element_text(angle = 90, vjust = 1, 
    size = 11, hjust = 1), 
    axis.text.y = element_text(vjust = 1, 
    size = 11, hjust = 1))+
   geom_text(size = 3) +
   
 coord_fixed()
```

![](world_happiness_report_files/figure-html/unnamed-chunk-10-1.png)<!-- -->

# South Asian Countries - Happiness Bar


```r
south_asia <- y17_full %>%
  group_by(region) %>% 
  select(country, rank, score, gdp, family, life_expectancy, freedom, generosity, corruption, dystopia) %>% 
  filter(region == "Southern Asia") 
```

```
## Adding missing grouping variables: `region`
```

```r
south_asia$country <- factor(south_asia$country, levels = south_asia$country[order(-south_asia$score)])

ggplot(south_asia, aes(x = country, y = rank, fill = country)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = rank), position = position_stack(vjust = 0.7), size = 3) +
  labs(title = "World Happiness Rank - South Asian Countries") +
  theme(plot.title = element_text(hjust = 0.5)) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-11-1.png)<!-- -->

```r
ggplot(south_asia, aes(x = country, y = score, fill = country)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(score, 2)), position = position_stack(vjust = 0.7), size = 3.5) +
  labs(title = "World Happiness Score - South Asian Countries") +
  theme(plot.title = element_text(hjust = 0.5)) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-11-2.png)<!-- -->

```r
ggplot(south_asia, aes(x = country, y = gdp, fill = country)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(gdp, 2)), position = position_stack(vjust = 0.7), size = 3.5) +
  labs(title = "Economy GDP of South Asian Countries") +
  theme(plot.title = element_text(hjust = 0.5)) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-11-3.png)<!-- -->

```r
ggplot(south_asia, aes(x = country, y = corruption, fill = country)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(corruption, 2)), position = position_stack(vjust = 0.7), size = 3.5) +
  labs(title = "Corruption Score of South Asian Countries") +
  theme(plot.title = element_text(hjust = 0.5)) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-11-4.png)<!-- -->

```r
ggplot(south_asia, aes(x = country, y = life_expectancy, fill = country)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(life_expectancy, 2)), position = position_stack(vjust = 0.7), size = 3.5) +
  labs(title = "Life Expectancy of South Asian Countries ") +
  theme(plot.title = element_text(hjust = 0.5)) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-11-5.png)<!-- -->


```r
count <- count(y17_full, region)

count <- count %>% 
  mutate(percent = round(n/sum(n) * 100, 2))

count
```

```
## # A tibble: 10 x 3
##    region                              n percent
##    <chr>                           <int>   <dbl>
##  1 Australia and New Zealand           2    1.29
##  2 Central and Eastern Europe         29   18.7 
##  3 Eastern Asia                        6    3.87
##  4 Latin America and Caribbean        22   14.2 
##  5 Middle East and Northern Africa    19   12.3 
##  6 North America                       2    1.29
##  7 Southeastern Asia                   8    5.16
##  8 Southern Asia                       7    4.52
##  9 Sub-Saharan Africa                 39   25.2 
## 10 Western Europe                     21   13.6
```

```r
ggplot(count, aes(x="", y = percent, fill=region)) + 
  geom_bar(width = 1, stat = "identity") +
  labs(title="No. of countries in regional chart", caption= "", y = "" , x = "") +
  geom_text(aes(label = n), position = position_stack(vjust = 0.5), size = 2.5) +
  coord_polar(theta="y") +
  theme_grey()
```

![](world_happiness_report_files/figure-html/unnamed-chunk-12-1.png)<!-- -->

# Happiness Score vs Region


```r
ggplot(y17_full, aes(x = region, y = score, fill = region)) +
  geom_bar(stat = "identity") +
   theme_minimal() +
  theme(axis.text.x=element_blank()) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-13-1.png)<!-- -->


# Economy vs Region


```r
ggplot(y17_full, aes(x = region, y = gdp, fill = region)) +
  geom_bar(stat = "identity") +
   theme_minimal() +
  theme(axis.text.x=element_blank()) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-14-1.png)<!-- -->

# Life Expectancy vs Region


```r
ggplot(y17_full, aes(x = region, y = life_expectancy, fill = region)) +
  geom_bar(stat = "identity") +
   theme_minimal() +
  theme(axis.text.x=element_blank()) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-15-1.png)<!-- -->

# Corruption vs Region


```r
ggplot(y17_full, aes(x = region, y = corruption, fill = region)) +
  geom_bar(stat = "identity") +
   theme_minimal() +
  theme(axis.text.x=element_blank()) 
```

![](world_happiness_report_files/figure-html/unnamed-chunk-16-1.png)<!-- -->

